import{_ as D,r as y,c as v,h as p,d as a,n as C,i as g,j as $,k as S,u as h,l as H,E as B,v as N,m as F,p as V,q as K,t as q,s as u,F as Q,x as X,y as Y,z as Z,A as ee,B as ae,C as E,o as te,D as se,b as J,G as oe,e as ne,H as ie}from"./index-BirWHe53.js";import{S as T}from"./config-DBxA65oN.js";import{S as le,C as j,F as re,P as ce,W as de,a as ue,b as pe,A as ve,c as me,D as be,d as U,G as ge,B as O,M as W,e as G,f as fe,g as ye,h as I,i as he,j as we,k as _e,l as ke}from"./three.module-CUIihH7M.js";const Ce={class:"cyber-login"},Se={class:"login-tabs"},xe={key:0,class:"cyber-form"},Me={class:"cyber-input-group"},$e=["disabled"],Le={class:"cyber-input-group"},ze=["disabled"],Pe=["disabled"],Ne={key:0},Fe={key:1,class:"loading-text"},Te={key:1,class:"cyber-form"},De={class:"cyber-input-group"},Re=["disabled"],Ae={class:"cyber-input-group"},Ge=["disabled"],Ie=["disabled"],Be={key:0},Ve={key:1},Ee={key:2},je=["disabled"],Ue={key:0},Oe={key:1,class:"loading-text"},We={__name:"LoginForm",emits:["logged"],setup(R,{emit:m}){const l=m,s=y({account:"",password:""}),t=y({email:"",code:""}),r=y(!1),n=y(!1),c=y(0),b=y("password");let w=null;async function f(){if(!s.value.account||!s.value.password){u.warning("请填写完整信息");return}r.value=!0;try{const e=await(await fetch(`http://${T}/api/user/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({account:s.value.account,password:s.value.password,rememberMe:!1})})).json();e.code===200?(localStorage.setItem("token",e.data.accessToken),localStorage.setItem("userName",s.value.account),u.success("登录成功"),l("logged")):u.error(e.message||"登录失败")}catch(i){u.error("网络错误"),console.error(i)}finally{r.value=!1}}async function M(){if(!t.value.email){u.warning("请输入邮箱");return}n.value=!0;let i=new FormData;i.append("email",t.value.email);try{const o=await(await fetch(`http://${T}/api/user/emailcode`,{method:"POST",body:i})).json();o.code===200?(u.success("验证码已发送，请查收邮箱"),c.value=60,w=setInterval(()=>{c.value--,c.value<=0&&(clearInterval(w),w=null)},1e3)):u.error(o.message||"发送失败")}catch(e){u.error("网络错误"),console.error(e)}finally{n.value=!1}}async function k(){if(!t.value.email||!t.value.code){u.warning("请填写完整信息");return}r.value=!0;let i=new FormData;i.append("email",t.value.email),i.append("code",t.value.code);try{const o=await(await fetch(`http://${T}/api/user/loginbycode`,{method:"POST",body:i})).json();console.log(o),o.code===200?(localStorage.setItem("token",o.data.accessToken),localStorage.setItem("userName",o.data.userInfo.userName),u.success("登录成功"),l("logged")):u.error(o.message||"登录失败")}catch(e){u.error("网络错误"),console.error(e)}finally{r.value=!1}}function L(i){b.value=i,r.value=!1,t.value={email:"",code:""},s.value={account:"",password:""}}return(i,e)=>{const o=B;return p(),v("div",Ce,[e[10]||(e[10]=a("div",{class:"cyber-header"},[a("div",{class:"cyber-line"}),a("h3",null,"登录"),a("div",{class:"cyber-line"})],-1)),a("div",Se,[a("button",{class:C({active:b.value==="password"}),onClick:e[0]||(e[0]=d=>L("password"))},"密码登录",2),a("button",{class:C({active:b.value==="code"}),onClick:e[1]||(e[1]=d=>L("code"))},"验证码登录",2)]),b.value==="password"?(p(),v("div",xe,[a("div",Me,[g(o,{size:"28"},{default:S(()=>[g(h(H),{class:"cyber-icon"})]),_:1}),$(a("input",{"onUpdate:modelValue":e[2]||(e[2]=d=>s.value.account=d),placeholder:"请输入用户名、手机号或者邮箱",class:"cyber-input",style:{outline:"none"},onKeyup:F(f,["enter"]),disabled:r.value},null,40,$e),[[N,s.value.account]])]),a("div",Le,[g(o,{size:"28"},{default:S(()=>[g(h(V),{class:"cyber-icon"})]),_:1}),$(a("input",{"onUpdate:modelValue":e[3]||(e[3]=d=>s.value.password=d),type:"password",placeholder:"请输入密码",class:"cyber-input",style:{outline:"none"},onKeyup:F(f,["enter"]),disabled:r.value},null,40,ze),[[N,s.value.password]])]),a("button",{onClick:f,class:C(["cyber-button",{loading:r.value}]),disabled:r.value},[r.value?(p(),v("span",Fe,e[6]||(e[6]=[a("span",{class:"loading-dots"},"正在处理",-1)]))):(p(),v("span",Ne,"确认")),e[7]||(e[7]=a("span",{class:"cyber-glow"},null,-1))],10,Pe)])):(p(),v("div",Te,[a("div",De,[g(o,{size:"28"},{default:S(()=>[g(h(K),{class:"cyber-icon"})]),_:1}),$(a("input",{"onUpdate:modelValue":e[4]||(e[4]=d=>t.value.email=d),placeholder:"请输入邮箱",class:"cyber-input",style:{outline:"none"},disabled:r.value},null,8,Re),[[N,t.value.email]])]),a("div",Ae,[g(o,{size:"28"},{default:S(()=>[g(h(V),{class:"cyber-icon"})]),_:1}),$(a("input",{"onUpdate:modelValue":e[5]||(e[5]=d=>t.value.code=d),placeholder:"请输入验证码",class:"cyber-input",style:{outline:"none"},onKeyup:F(k,["enter"]),disabled:r.value},null,40,Ge),[[N,t.value.code]]),a("button",{class:"get-code-btn",onClick:M,disabled:n.value||c.value>0||!t.value.email},[c.value===0&&!n.value?(p(),v("span",Be,"获取验证码")):n.value?(p(),v("span",Ve,"发送中...")):(p(),v("span",Ee,q(c.value)+"s",1))],8,Ie)]),a("button",{onClick:k,class:C(["cyber-button",{loading:r.value}]),disabled:r.value},[r.value?(p(),v("span",Oe,e[8]||(e[8]=[a("span",{class:"loading-dots"},"正在处理",-1)]))):(p(),v("span",Ue,"登录")),e[9]||(e[9]=a("span",{class:"cyber-glow"},null,-1))],10,je)]))])}}},He=D(We,[["__scopeId","data-v-d740b852"]]),Ke={class:"cyber-register"},Je={class:"cyber-form"},qe=["onUpdate:modelValue","type","placeholder","disabled"],Qe=["disabled"],Xe={key:0},Ye={key:1,class:"loading-text"},Ze={__name:"RegisterForm",emits:["registered"],setup(R,{emit:m}){const l=m,s=y({userName:"",email:"",phoneNumber:"",password:"",passwordConfirm:""}),t=y(!1);function r(){return/^\w{3,20}$/.test(s.value.userName)?/^\w+@\w+\.\w{2,3}$/.test(s.value.email)?/^1[3-9]\d{9}$/.test(s.value.phoneNumber)?s.value.password!==s.value.passwordConfirm?(u.warning("两次密码不一致"),!1):!0:(u.warning("请输入正确手机号"),!1):(u.warning("请输入有效邮箱"),!1):(u.warning("用户名需3-20位字母数字"),!1)}async function n(){if(r()){t.value=!0;try{const b=await(await fetch(`http://${T}/api/user/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:s.value.userName,email:s.value.email,phoneNumber:s.value.phoneNumber,password:s.value.password,confirmPassword:s.value.passwordConfirm})})).json();b.code===200?(u.success("注册成功"),l("registered")):u.error(b.message||"注册失败")}catch(c){u.error("网络错误"),console.error(c)}finally{t.value=!1}}}return(c,b)=>{const w=B;return p(),v("div",Ke,[b[2]||(b[2]=a("div",{class:"cyber-header"},[a("div",{class:"cyber-line"}),a("h3",null,"注册"),a("div",{class:"cyber-line"})],-1)),a("div",Je,[(p(!0),v(Q,null,X([{icon:h(H),model:"userName",placeholder:"用户名"},{icon:h(K),model:"email",placeholder:"邮箱"},{icon:h(ae),model:"phoneNumber",placeholder:"手机号"},{icon:h(E),model:"password",placeholder:"密码",type:"password"},{icon:h(E),model:"passwordConfirm",placeholder:"确认密码",type:"password"}],(f,M)=>(p(),v("div",{key:M,class:"cyber-input-group"},[g(w,{size:16,class:"cyber-icon"},{default:S(()=>[(p(),Y(Z(f.icon)))]),_:2},1024),$(a("input",{"onUpdate:modelValue":k=>s.value[f.model]=k,type:f.type||"text",placeholder:f.placeholder,class:"cyber-input",style:{outline:"none"},onKeyup:F(n,["enter"]),disabled:t.value},null,40,qe),[[ee,s.value[f.model]]])]))),128))]),a("button",{onClick:n,class:C(["cyber-button",{loading:t.value}]),disabled:t.value},[t.value?(p(),v("span",Ye,b[0]||(b[0]=[a("span",{class:"loading-dots"},"正在处理",-1)]))):(p(),v("span",Xe,"确认")),b[1]||(b[1]=a("span",{class:"cyber-glow"},null,-1))],10,Qe)])}}},ea=D(Ze,[["__scopeId","data-v-1be24acf"]]),aa={class:"login-3d-container"},ta={__name:"Login3DModel",setup(R){const m=y(null);let l,s,t,r,n=null;te(()=>{c(),b(),k()}),se(()=>{t&&t.dispose(),l&&l.clear()});function c(){l=new le,l.background=new j(657930),l.fog=new re(657930,5,15),s=new ce(75,m.value.clientWidth/m.value.clientHeight,.1,1e3),s.position.set(0,0,5),t=new de({antialias:!0,alpha:!0}),t.setSize(m.value.clientWidth,m.value.clientHeight),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),t.shadowMap.enabled=!0,t.shadowMap.type=ue,t.outputColorSpace=pe,t.toneMapping=ve,t.toneMappingExposure=1.2,m.value.appendChild(t.domElement),r=new ke,window.addEventListener("resize",L)}function b(){const i=new me(4210752,.6);l.add(i);const e=new be(46300,1);e.position.set(5,5,5),e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,e.shadow.camera.near=.5,e.shadow.camera.far=50,l.add(e);const o=new U(16711830,1,10);o.position.set(-3,2,3),l.add(o);const d=new U(65535,1,10);d.position.set(3,-2,-3),l.add(d),w(),f(),M()}function w(){const i=new ge,e=new O(1,1,1),o=new W({color:46300,transparent:!0,opacity:.8,wireframe:!1}),d=new G(e,o);d.castShadow=!0,d.receiveShadow=!0,i.add(d);const x=new O(1.2,1.2,1.2),A=new fe({color:46300,wireframe:!0,transparent:!0,opacity:.3}),z=new G(x,A);i.add(z),d.rotation.x=.5,d.rotation.y=.3,n=i,l.add(i)}function f(){const e=new Float32Array(450),o=new Float32Array(150*3),d=new Float32Array(150);for(let _=0;_<150;_++){e[_*3]=(Math.random()-.5)*12,e[_*3+1]=(Math.random()-.5)*12,e[_*3+2]=(Math.random()-.5)*12;const P=new j;P.setHSL(Math.random()*.3+.5,1,.5),o[_*3]=P.r,o[_*3+1]=P.g,o[_*3+2]=P.b,d[_]=Math.random()*.1+.02}const x=new ye;x.setAttribute("position",new I(e,3)),x.setAttribute("color",new I(o,3)),x.setAttribute("size",new I(d,1));const A=new he({size:.05,vertexColors:!0,transparent:!0,opacity:.8,sizeAttenuation:!0}),z=new we(x,A);l.add(z),n.particles=z}function M(){const i=new _e(20,20),e=new W({color:1710618,transparent:!0,opacity:.3,wireframe:!0}),o=new G(i,e);o.rotation.x=-Math.PI/2,o.position.y=-3,o.receiveShadow=!0,l.add(o),n.ground=o}function k(){if(requestAnimationFrame(k),r.getDelta(),n){if(n.rotation.x+=.005,n.rotation.y+=.008,n.children&&n.children[1]&&(n.children[1].rotation.x-=.003,n.children[1].rotation.y-=.005),n.particles){n.particles.rotation.y+=.001;const i=n.particles.geometry.attributes.position.array;for(let e=0;e<i.length;e+=3)i[e+1]+=Math.sin(Date.now()*.001+e)*5e-4;n.particles.geometry.attributes.position.needsUpdate=!0}n.ground&&(n.ground.rotation.z+=.001)}t.render(l,s)}function L(){m.value&&s&&t&&(s.aspect=m.value.clientWidth/m.value.clientHeight,s.updateProjectionMatrix(),t.setSize(m.value.clientWidth,m.value.clientHeight))}return(i,e)=>(p(),v("div",aa,[a("div",{ref_key:"containerRef",ref:m,class:"three-container"},null,512),e[0]||(e[0]=J('<div class="overlay-text" data-v-9d2d615b><div class="cyber-title" data-v-9d2d615b>云电智绘</div><div class="cyber-subtitle" data-v-9d2d615b>新一代点云数据处理平台</div></div><div class="cyber-border" data-v-9d2d615b><div class="border-corner top-left" data-v-9d2d615b></div><div class="border-corner top-right" data-v-9d2d615b></div><div class="border-corner bottom-left" data-v-9d2d615b></div><div class="border-corner bottom-right" data-v-9d2d615b></div></div>',2))]))}},sa=D(ta,[["__scopeId","data-v-9d2d615b"]]),oa={class:"cyber-auth-view"},na={class:"cyber-card"},ia={class:"card-left"},la={class:"card-right"},ra={class:"cyber-tabs"},ca={class:"cyber-form-container"},da={key:0,class:"form-center-wrapper"},ua={key:1,class:"form-center-wrapper"},pa={__name:"LoginView",setup(R){const m=ne(),l=y("login");async function s(){await m.push("/")}function t(){l.value="login",u.success("注册成功，请登录")}function r(){m.push("/")}return(n,c)=>{const b=B;return p(),v("div",oa,[a("button",{class:"back-button",onClick:r},[g(b,{size:"20"},{default:S(()=>[g(h(ie))]),_:1}),c[2]||(c[2]=a("span",null,"返回首页",-1))]),c[3]||(c[3]=J('<div class="neon-bg" data-v-57a1c712><div class="neon-light neon-light-1" data-v-57a1c712></div><div class="neon-light neon-light-2" data-v-57a1c712></div><div class="neon-light neon-light-3" data-v-57a1c712></div><div class="neon-light neon-light-4" data-v-57a1c712></div><div class="neon-light neon-light-5" data-v-57a1c712></div><div class="neon-light neon-light-6" data-v-57a1c712></div><div class="neon-light neon-light-7" data-v-57a1c712></div></div>',1)),a("div",na,[a("div",ia,[g(sa)]),a("div",la,[a("div",ra,[a("button",{class:C({active:l.value==="login"}),onClick:c[0]||(c[0]=w=>l.value="login")}," 已有账号？ ",2),a("button",{class:C({active:l.value==="register"}),onClick:c[1]||(c[1]=w=>l.value="register")}," 没有账号？ ",2)]),a("div",ca,[g(oe,{name:"cyber-fade",mode:"out-in"},{default:S(()=>[l.value==="login"?(p(),v("div",da,[g(He,{onLogged:s,class:"cyber-form"})])):(p(),v("div",ua,[g(ea,{onRegistered:t,class:"cyber-form"})]))]),_:1})])])])])}}},ga=D(pa,[["__scopeId","data-v-57a1c712"]]);export{ga as default};
